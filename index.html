<!DOCTYPE html>
<html>
<head>
  <title>A demo!</title>
  <style>
    svg { border: 1px solid black; }
    svg g rect.node-shape { border-radius: 5px !important; fill:#ffecb3 !important; cursor: move; }
    svg g text.node-name { font-weight: 800 !important }
    svg g rect.node-bar { fill: green !important }
    svg g text.node-value { fill:rgb(0,0,0) !important; font-size: 15px; cursor: pointer; }
    svg line.edge-line { stroke:rgb(0,0,0) !important }
    svg path.edge-head { fill:rgb(0,0,0) !important }
  </style>
  <script src="bower_components/d3/d3.js"></script>
  <script src="bower_components/lodash/lodash.js"></script>
  <script src="bower_components/graphlib/dist/graphlib.core.js"></script>
  <script src="bower_components/dagre/dist/dagre.core.js"></script>
  <script src="bower_components/jquery/dist/jquery.js"></script>
  <script src="bower_components/jsbayes/jsbayes.js"></script>
  <script src="jsbayes-viz.js"></script>
  <script>
  function getGraph() {
    var graph = jsbayes.newGraph();
    graph.saveSamples = true;
    
    var n1 = graph.addNode('n1', ['true', 'false']);
    var n2 = graph.addNode('n2', ['true', 'false']);
    var n3 = graph.addNode('n3', ['true', 'false']);
    var n4 = graph.addNode('n4', ['true', 'false']);
    var n5 = graph.addNode('n5', ['yes', 'maybe', 'no']);
    
    n2.addParent(n1);
    n3.addParent(n2);
    n3.addParent(n4);
    n5.addParent(n4);
    
    graph.reinit();
    graph.sample(10000);
    
    var g = jsbayesviz.fromGraph(graph);
    return g;
  }
  
  $(document).ready(function() {
    (function(window) { 
      var graph = getGraph();
      jsbayesviz.draw({
        id: '#bbn',
        width: 800,
        height: 800,
        graph: graph,
        samples: 15000
      });
      
      $('#btnDownloadJson').click(function() {
        jsbayesviz.downloadSamples(graph, true);
      });
      
      $('#btnDownloadCsv').click(function() {
        jsbayesviz.downloadSamples(graph, false, { rowDelimiter: '\n', fieldDelimiter: ',' });
      });
    })(window);
  });
  </script>
</head>
<body>
  <svg id="bbn">
  </svg>
  <div>
    <button id="btnDownloadJson">download samples as json</button>
    <button id="btnDownloadCsv">download samples as csv</button>
  </div>
</body>
</html>
